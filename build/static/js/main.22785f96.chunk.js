(this["webpackJsonphackoff-frontend"]=this["webpackJsonphackoff-frontend"]||[]).push([[0],{21:function(e,t,n){},26:function(e,t,n){e.exports=n(43)},31:function(e,t,n){},32:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(22),s=n.n(o),i=(n(31),n(9)),l=n(11),c=n(2),u=n(3),h=n(5),f=n(4),p=n(6),d=(n(32),function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"Main"},r.a.createElement("div",{className:"firstHalf"},r.a.createElement("img",{src:"/images/computer.svg",alt:"Woman",className:"logo"})),r.a.createElement("div",{className:"secondHalf"},r.a.createElement("span",{className:"title"},"Ergonomics"),r.a.createElement("br",null),r.a.createElement("span",{className:"tagline"},"Made Simple"),r.a.createElement("br",null),r.a.createElement(i.b,{to:"onboarding",className:"button firstButton"},"Let's Go")))}}]),t}(r.a.Component)),m=(n(38),n(39),function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{class:"InfoCard"},r.a.createElement("div",{class:"Alignment"},this.props.children,r.a.createElement("div",{classNamee:"InfoNav"},this.props.previous?r.a.createElement(i.b,{to:this.props.previous,className:"left"},"Previous"):null,this.props.next?r.a.createElement(i.b,{to:this.props.next,className:"right"},"Next"):null)))}}]),t}(r.a.Component)),v=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{class:"MainApp"},r.a.createElement(m,{next:"setup"},r.a.createElement("h2",null,"HOW IT WORKS"),r.a.createElement("p",null,"Keep a good and straight posture before you start the posture monitor. Any major deviation from the intial posture will alert you to get back to the proper posture."),r.a.createElement("ul",null,r.a.createElement("li",null,"Laptop should be placed such that top of the screen is at eye level."),r.a.createElement("li",null,"Elbows should rest at 90 degree angle by your side."),r.a.createElement("li",null,"Every 10 minutes, take a short (10-20 second) break. Take your hands off the keyboard and move!"),r.a.createElement("li",null,"The distance between the eye and the screen should be at least of 20-25 inches (approximately 50-63 cm). The place of the screen should be as far away as possible and, optimally, it is recommended to increase the font size."))))}}]),t}(r.a.Component),b=(n(21),n(17)),y=n.n(b),g=(n(41),n(18)),E=function(){function e(t,n){Object(c.a)(this,e);var a=window.ml5;this.poser=a.poseNet(t,(function(){return null})),this.defaults=null,this.points={eyes:{},shoulders:{}},this.width=t.width,this.height=t.height,n.width=t.width,n.height=t.height,this.ctx=n&&n.getContext("2d")}return Object(u.a)(e,[{key:"setupListener",value:function(e){var t=this;this.poser.on("pose",(function(n){var a=t.calculatePoseCorrectness(n);console.log(a),e(a),t.ctx&&t.defaults&&t.drawCanvas(a)}))}},{key:"calculatePoseCorrectness",value:function(e){for(var t=0;t<e.length;t++)for(var n=e[t].pose,a=0;a<n.keypoints.length;a++){var r=n.keypoints[2].position,o=n.keypoints[1].position;if(this.points.eyes.left=o,this.points.eyes.right=r,this.points.shoulders.left=n.keypoints[6].position,this.points.shoulders.right=n.keypoints[5].position,this.defaults||(this.defaults={leftEye:o,rightEye:r}),Math.abs(r.y-this.defaults.leftEye.y)<30)return!0;if(Math.abs(r.y-this.defaults.rightEye.y)>30)return!1}}},{key:"drawCanvas",value:function(e){var t=this.ctx,n=this.points,a=n.shoulders,r=n.eyes;t.clearRect(0,0,this.width,this.height);var o=e?"green":"red";k(t,a.left.y,a.left.x,5,o),k(t,a.right.y,a.right.x,5,o),k(t,r.left.y,r.left.x,5,o),k(t,r.right.y,r.right.x,5,o),function(e,t,n,a,r){var o=Object(g.a)(t,2),s=o[0],i=o[1],l=Object(g.a)(n,2),c=l[0],u=l[1];e.beginPath(),e.moveTo(i*r,s*r),e.lineTo(u*r,c*r),e.lineWidth=1,e.strokeStyle=a,e.stroke()}(t,[a.left.y,a.left.x],[a.right.y,a.right.x],o,1)}}]),e}();function k(e,t,n,a,r){e.beginPath(),e.arc(n,t,a,0,2*Math.PI),e.fillStyle=r,e.fill()}var w=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={stream:null},n.videoRef=null,n.canvasRef=null,n.blinkRef=null,n.setVideoRef=function(e){n.videoRef=e,e&&(e.srcObject=n.state.stream)},n.setCanvasRef=function(e){n.canvasRef=e},n.startPosture=function(){console.log("hello"),new E(n.videoRef,n.canvasRef).setupListener((function(e){var t=n.props.onPose;t&&t(e)}))},n.blinkHandler=function(){var e=new window.eyePlayer;console.log(n.blinkRef),e.init(n.blinkRef,document.createElement("canvas")),e.start(),document.addEventListener("blinkEvent",(function(){console.log("BLINKKK"),n.props.onBlink()}))},n.startAll=function(){window.startnotify&&window.startnotify(),n.startPosture(),n.props.onBlink&&(console.log("blink on"),n.blinkHandler())},n.setBlinkRef=function(e){n.blinkRef=e,e&&(e.srcObject=n.state.stream)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e;return y.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.awrap(new Promise((function(e,t){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{height:550,width:400}}).then((function(t){return e(t)})).catch(t):t(new Error("No Webcam found."))})));case 2:e=t.sent,this.setState({stream:e});case 4:case"end":return t.stop()}}),null,this)}},{key:"renderResult",value:function(){var e=this.state,t=e.isAnalysing,n=e.isPoseGood;return t?null===n?"Calculating...":n?"Correct Pose":"Wrong Pose":null}},{key:"render",value:function(){var e=this.state.stream;return r.a.createElement("div",{className:"App"},e&&r.a.createElement("div",{className:"videoContainer"},r.a.createElement("video",{width:"400px",height:"550px",autoPlay:!0,className:"video",onPlay:this.startAll,ref:this.setVideoRef}),r.a.createElement("video",{autoPlay:!0,ref:this.setBlinkRef,id:"notwanted"}),r.a.createElement("canvas",{className:"overlay",ref:this.setCanvasRef,id:"drawCanvas"})))}}]),t}(r.a.Component),j=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={posture:null},n.renderText=function(){var e=n.state.posture,t="Bad";return null===e?t="Loading":e&&(t="Good"),r.a.createElement("p",{className:t},"Posture is ",t,"!")},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{class:"Card"},r.a.createElement(w,{onPose:function(t){return e.setState({posture:t})}}),r.a.createElement("h2",null),this.renderText(),r.a.createElement(i.b,{id:"initiator",to:"/dash",disabled:null===this.state.posture},"Start Tracking"))}}]),t}(r.a.Component),O=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{class:"MainApp"},r.a.createElement(j,null))}}]),t}(r.a.Component),P=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={posture:null},n.renderText=function(){var e=n.state.posture,t="Bad";return null===e?t="Loading":e&&(t="Good"),r.a.createElement("p",{className:t},"Posture is ",t,"!")},n.onPoseHandleer=function(e){n.setState({posture:e}),n.props.onPose&&n.props.onPose(e)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{class:"Card"},r.a.createElement(w,{onBlink:this.props.onBlink,onPose:this.onPoseHandleer}),r.a.createElement("h2",null),this.renderText(),r.a.createElement("button",{id:"initiator",onClick:this.props.onStop},"Stop Tracking"))}}]),t}(r.a.Component),C=n(25),x=n.n(C),T=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={start:new Date,diff:null,blinks:0,truePose:0,falsePose:0,tenSecArray:[],kill:!1},n.timer=null,n.stopMatchTimer=null,n.blinkTimer=null,n.incrementBlink=function(){var e=n.state,t=e.blinks;e.kill||(console.log("BLINK",t),n.setState({blinks:t+1}))},n.throttleBlink=function(){n.blinkTimer||(n.timer=setTimeout((function(){n.onPoseChange(),n.blinkTimer=null}),2e3))},n.pushToArray=function(e){var t=n.state.tenSecArray;if(10===t.length){var a=0;t.forEach((function(e){e&&a++})),a<5&&(window.correctpos?window.correctpos():alert("You are crouching, fix your pose!")),n.setState({tenSecArray:[]})}else t.push(e)},n.onPoseChange=function(e){var t=n.state,a=t.truePose,r=t.falsePose;t.kill||(console.log(a,r),n.pushToArray(e),e?n.setState({truePose:a+1}):n.setState({falsePose:r+1}))},n.throttlePoseChange=function(e){n.timer||(n.timer=setTimeout((function(){n.onPoseChange(e),n.timer=null}),1e3))},n.onStopTrack=function(e){e.preventDefault(),clearInterval(n.stopMatchTimer),n.setState({kill:!0}),window.endnotify&&window.endnotify()},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.stopMatchTimer=setInterval((function(){var t=new Date-e.state.start;e.setState({diff:t})}),1e3)}},{key:"render",value:function(){var e=this.state,t=e.blinks,n=e.diff,a=e.truePose,o=e.falsePose,s=e.kill,i=t/(n/1e3/60),l=a/(a+o)*100;return r.a.createElement("div",{style:{display:"flex",margin:"40px",justifyContent:"space-evenly"}},!s&&r.a.createElement(P,{onPose:this.throttlePoseChange,onBlink:this.incrementBlink,onStop:this.onStopTrack}),r.a.createElement(m,{class:"infoinfo"},r.a.createElement("h2",{className:"reportTitle"},"Reports"),this.state.diff?r.a.createElement("h3",null,"Time since start: ",x()(n)):null,r.a.createElement("h3",{className:"blinksPM"},"Blinks per minute: ",i),r.a.createElement("h3",{className:"ppp"},"Posture Perfection Percentage: ",Math.round(l),"%")))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement((function(e){return r.a.createElement(i.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/onboarding"},r.a.createElement(v,null)),r.a.createElement(l.a,{path:"/setup"},r.a.createElement(O,null)),r.a.createElement(l.a,{path:"/dash"},r.a.createElement(T,null)),r.a.createElement(l.a,{path:"/"},r.a.createElement(d,null))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.22785f96.chunk.js.map